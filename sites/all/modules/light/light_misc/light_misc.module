<?php


function mitd_nid($uid, $op_nid) {

	$query = new EntityFieldQuery();
	$items_nids = array();
	$query->entityCondition('entity_type', 'node')
	  ->entityCondition('bundle', 'proposals')
	  ->propertyCondition('status', 1) // published? yes
	  ->propertyCondition('uid', $uid)
	  ->fieldCondition('field_opportunity', 'nid', $op_nid);
	$result = $query->execute();

	if (isset($result['node'])) {
	  $items_nids = array_keys($result['node']);
	  //$items = entity_load('node', $items_nids);
	}

	return $items_nids;

}

function mitd_opportunity_count($uid) {
	$query = db_select('node', 'n')
	  ->fields('n')
      ->condition('type', 'opportunity')
     ->condition('uid', $uid)
      ->countQuery()
      ->execute()
       ->fetchAssoc();
     return $query['expression'];
}

function mitd_proposals_count($nid) {

  $result = array();
  if (module_exists('views'))
    $result = views_get_view_result('proposals', 'block_2', $nid);

  return count($result);
}

function light_misc_form_alter(&$form, &$form_state, $form_id) {
	global $user;
	switch ($form_id) {
		case "user_login":
		$options = array('attributes' => array('class' => 'on-right'));
		$form['resetlink'] = array(
			'#type' => 'item',
			'#markup' => l('Forgot Password?', 'user/password', $options)
			);
		break;
	}
}

/**
* Implements hook_menu().
*/
function light_misc_menu() {

	$items['proposal/%'] = array(
    'page callback' => 'light_misc_proposal_shortlisting',
    'access callback' => TRUE,
    'type' => MENU_CALLBACK,
  );

  return $items;
}

function light_misc_proposal_shortlisting() {
	$nid = arg(1);
	
	url($path, array('query' => $query, 'destination' => $_GET['q']));
	

}